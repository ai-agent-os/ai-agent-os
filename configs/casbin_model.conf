[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
# 当前阶段使用的关系
g = _, _        # 用户-角色关系：g(user, role)
g2 = _, _       # 资源继承关系：g2(resource, parent_resource)

# 预留：组织架构关系（后续扩展）
g3 = _, _       # 用户-部门关系：g3(user, department_path)
g4 = _, _       # 部门-角色关系：g4(department_path, role)

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 支持多种权限匹配：
# 1. 直接权限：用户直接拥有权限
# 2. 角色权限：用户通过角色拥有权限
# 3. 资源继承：子资源继承父资源权限
# 4. 路径匹配：支持通配符和层级匹配
# 5. 预留：组织架构权限（通过 g3、g4 关系，待实现）
# 
# 当前实现（简化版，不包含组织架构）：
# - g(r.sub, p.sub): 用户通过角色拥有权限
# - r.obj == p.obj: 精确匹配资源路径
# - g2(r.obj, p.obj): 子资源继承父资源权限
# - keyMatch2(r.obj, p.obj): 路径通配符匹配（支持 * 和 **）
# - r.act == p.act: 操作类型匹配
m = g(r.sub, p.sub) && (r.obj == p.obj || g2(r.obj, p.obj) || keyMatch2(r.obj, p.obj)) && r.act == p.act

