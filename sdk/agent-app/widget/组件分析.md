# Widget 组件分析报告

## 📊 现有组件清单

### ✅ 已实现的组件（9个）

| 组件 | 类型常量 | 文件 | 功能 | 状态 |
|------|---------|------|------|------|
| Input | `TypeInput` | `input.go` | 文本输入框，支持密码、前后缀 | ✅ 完整 |
| Text | `TypeText` | `text.go` | 纯文本显示（支持格式化） | ✅ 完整 |
| TextArea | `TypeTextArea` | `text_area.go` | 多行文本输入 | ✅ 完整 |
| Select | `TypeSelect` | `select.go` | 下拉选择框 | ✅ 完整 |
| Switch | `TypeSwitch` | `switch.go` | 开关/切换器 | ✅ 完整 |
| Timestamp | `TypeTimestamp` | `timestamp.go` | 时间戳选择器 | ✅ 完整 |
| User | `TypeUser` | `user.go` | 用户选择器 | ✅ 完整 |
| ID | `TypeID` | `id.go` | ID显示字段 | ✅ 完整 |
| Link | `TypeLink` | `link.go` | 链接组件 | ✅ 完整 |

### ❌ 已定义但未实现的组件（5个）

| 组件 | 类型常量 | 缺失原因 | 优先级 |
|------|---------|----------|--------|
| Number | `TypeNumber` | 在 `widget.go` 中定义，但无实现文件和注册 | 🔴 高 |
| Float | `TypeFloat` | 在 `widget.go` 中定义，但无实现文件和注册 | 🔴 高 |
| Files | `TypeFiles` | 在 `widget.go` 中定义，但无实现文件和注册 | 🟡 中 |
| Checkbox | `TypeCheckbox` | 在 `widget.go` 中定义，但无实现文件和注册 | 🟡 中 |
| Radio | `TypeRadio` | 在 `widget.go` 中定义，但无实现文件和注册 | 🟡 中 |

### 📦 容器组件（2个）

| 组件 | 类型常量 | 状态 | 说明 |
|------|---------|------|------|
| Table | `TypeTable` | ✅ 完整 | 表格容器，支持嵌套 |
| Form | `TypeForm` | ✅ 完整 | 表单容器，支持嵌套 |

---

## 🎯 推荐添加的组件

### 🔴 高优先级（必须补充）

#### 1. **Number 数字输入组件** ⭐⭐⭐
- **类型**: `TypeNumber`
- **用途**: 整数输入（如年龄、数量、序号等）
- **配置项**:
  - `step` - 步长（点击增减按钮的步进值）
  - `default` - 默认值
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小值（如 `validate:"min=1"`）
  - `max` - 最大值（如 `validate:"max=100"`）
  - `required` - 必填
- **实现难度**: ⭐ 低
- **业务场景**: 订单数量、用户年龄、分页大小等
- **示例**: 
  ```go
  Quantity int `json:"quantity" widget:"name:数量;type:number;step:1;default:0" validate:"required,min=1,max=999"`
  ```

#### 2. **Float 浮点数输入组件** ⭐⭐⭐
- **类型**: `TypeFloat`
- **用途**: 小数输入（如价格、评分、百分比等）
- **配置项**:
  - `precision` - 小数位数（显示和输入精度）
  - `step` - 步长（点击增减按钮的步进值）
  - `default` - 默认值
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小值（如 `validate:"min=0.01"`）
  - `max` - 最大值（如 `validate:"max=9999.99"`）
  - `required` - 必填
- **实现难度**: ⭐ 低
- **业务场景**: 商品价格、评分、权重等
- **示例**: 
  ```go
  Price float64 `json:"price" widget:"name:价格;type:float;precision:2;step:0.01;default:0.00" validate:"required,min=0.01,max=9999.99"`
  ```

#### 3. **Checkbox 复选框组件** ⭐⭐⭐
- **类型**: `TypeCheckbox`
- **用途**: 多选（如兴趣爱好、标签选择等）
- **配置项**:
  - `options` - 选项列表（逗号分隔）
  - `default` - 默认选中项（逗号分隔）
- **实现难度**: ⭐ 低
- **业务场景**: 权限选择、标签、分类等

#### 4. **Radio 单选框组件** ⭐⭐
- **类型**: `TypeRadio`
- **用途**: 单选（如性别、状态等）
- **配置项**:
  - `options` - 选项列表（逗号分隔）
  - `default` - 默认选中项
- **实现难度**: ⭐ 低
- **业务场景**: 性别、订单状态、支付方式等

---

### 🟡 中优先级（常用功能）

#### 5. **Files 文件上传组件** ⭐⭐
- **类型**: `TypeFiles`
- **用途**: 文件上传（图片、文档、视频等）
- **配置项**:
  - `accept` - 接受的文件类型（如 `image/*`, `.pdf` 等）
  - `maxSize` - 最大文件大小（MB）
  - `maxCount` - 最大上传数量
  - `multiple` - 是否支持多选
- **实现难度**: ⭐⭐⭐ 中
- **业务场景**: 头像上传、附件上传、图片管理等

#### 6. **Date 日期选择器** ⭐⭐
- **类型**: `TypeDate`（新增类型）
- **用途**: 日期选择（不含时间）
- **配置项**:
  - `format` - 日期格式（如 `YYYY-MM-DD`）
  - `default` - 默认日期
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小日期（如 `validate:"min=2024-01-01"`）
  - `max` - 最大日期（如 `validate:"max=2024-12-31"`）
  - `required` - 必填
- **实现难度**: ⭐⭐ 低
- **业务场景**: 生日、起止日期、有效期等

#### 7. **DateTime 日期时间选择器** ⭐⭐
- **类型**: `TypeDateTime`（新增类型）
- **用途**: 日期+时间选择
- **配置项**:
  - `format` - 日期时间格式
  - `default` - 默认日期时间
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小日期时间
  - `max` - 最大日期时间
  - `required` - 必填
- **实现难度**: ⭐⭐ 低
- **业务场景**: 预约时间、截止时间等

#### 8. **Range 滑块组件** ⭐
- **类型**: `TypeRange`（新增类型）
- **用途**: 数值范围选择
- **配置项**:
  - `step` - 步长
  - `default` - 默认值（范围值，如 `0-100`）
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小值
  - `max` - 最大值
- **实现难度**: ⭐⭐ 低
- **业务场景**: 价格区间、评分区间、音量调节等

#### 9. **Color 颜色选择器** ⭐
- **类型**: `TypeColor`（新增类型）
- **用途**: 颜色选择
- **配置项**:
  - `format` - 颜色格式（hex, rgb, rgba）
  - `default` - 默认颜色
- **实现难度**: ⭐⭐ 低
- **业务场景**: 主题色设置、标签颜色等

---

### 🟢 低优先级（增强功能）

#### 10. **RichText 富文本编辑器** ⭐
- **类型**: `TypeRichText`（新增类型）
- **用途**: 富文本编辑（如博客、公告等）
- **配置项**:
  - `toolbar` - 工具栏配置
  - `height` - 编辑器高度
- **实现难度**: ⭐⭐⭐⭐ 高
- **业务场景**: 文章编辑、公告发布等

#### 11. **Code 代码编辑器** ⭐
- **类型**: `TypeCode`（新增类型）
- **用途**: 代码编辑（支持语法高亮）
- **配置项**:
  - `language` - 编程语言
  - `theme` - 主题
- **实现难度**: ⭐⭐⭐⭐ 高
- **业务场景**: 脚本编辑、配置文件等

#### 12. **Image 图片选择器** ⭐
- **类型**: `TypeImage`（新增类型，Files 的特化版本）
- **用途**: 图片上传和预览
- **配置项**:
  - `maxSize` - 最大文件大小
  - `aspectRatio` - 宽高比
  - `preview` - 是否预览
- **实现难度**: ⭐⭐⭐ 中
- **业务场景**: 头像、封面图、轮播图等

#### 13. **Tag 标签组件** ⭐
- **类型**: `TypeTag`（新增类型）
- **用途**: 标签输入和显示
- **配置项**:
  - `options` - 可选标签列表
  - `maxCount` - 最大标签数
- **实现难度**: ⭐⭐ 低
- **业务场景**: 文章标签、商品分类等

#### 14. **Rate 评分组件** ⭐
- **类型**: `TypeRate`（新增类型）
- **用途**: 星级评分
- **配置项**:
  - `max` - 最大星级（默认5）
  - `allowHalf` - 是否允许半星
  - `default` - 默认评分
- **实现难度**: ⭐⭐ 低
- **业务场景**: 商品评分、服务评价等

#### 15. **Tree 树形选择器** ⭐
- **类型**: `TypeTree`（新增类型）
- **用途**: 树形结构选择（如部门、分类等）
- **配置项**:
  - `multiple` - 是否多选
  - `checkable` - 是否可勾选
- **实现难度**: ⭐⭐⭐ 中
- **业务场景**: 组织架构、商品分类等

#### 16. **Cascader 级联选择器** ⭐
- **类型**: `TypeCascader`（新增类型）
- **用途**: 级联选择（如省市区）
- **配置项**:
  - `options` - 级联数据源
- **实现难度**: ⭐⭐⭐ 中
- **业务场景**: 地址选择、分类选择等

#### 17. **Time 时间选择器** ⭐
- **类型**: `TypeTime`（新增类型）
- **用途**: 时间选择（不含日期）
- **配置项**:
  - `format` - 时间格式
  - `default` - 默认时间
- **实现难度**: ⭐⭐ 低
- **业务场景**: 营业时间、提醒时间等

#### 18. **Progress 进度条** ⭐
- **类型**: `TypeProgress`（新增类型）
- **用途**: 进度显示（只读）
- **配置项**:
  - `format` - 显示格式
  - `strokeWidth` - 线条宽度
- **实现难度**: ⭐⭐ 低
- **业务场景**: 任务进度、完成度等

#### 19. **Slider 滑块组件** ⭐
- **类型**: `TypeSlider`（新增类型）
- **用途**: 单值滑块选择
- **配置项**:
  - `step` - 步长
  - `default` - 默认值
- **验证规则**（使用 `validate` 标签）:
  - `min` - 最小值
  - `max` - 最大值
- **实现难度**: ⭐⭐ 低
- **业务场景**: 音量、亮度、温度等

---

## 📋 实现建议

### 第一阶段：补充已定义但未实现的组件（立即执行）

1. ✅ **Number 组件** - 优先级最高
2. ✅ **Float 组件** - 优先级最高
3. ✅ **Checkbox 组件** - 常用功能
4. ✅ **Radio 组件** - 常用功能

### 第二阶段：文件上传功能（短期）

5. ✅ **Files 组件** - 业务必需

### 第三阶段：日期时间增强（中期）

6. ✅ **Date 组件** - 常用
7. ✅ **DateTime 组件** - 常用
8. ✅ **Time 组件** - 可选

### 第四阶段：增强组件（长期）

根据业务需求逐步添加其他组件。

---

## 🎨 组件设计建议

### ⚠️ 重要设计原则

**验证规则 vs 组件配置的分离：**

- ✅ **组件配置（widget 标签）**: 只包含 UI 展示和交互相关的配置
  - `step` - 步长
  - `precision` - 精度
  - `default` - 默认值
  - `placeholder` - 占位符
  - `format` - 格式化
  
- ✅ **验证规则（validate 标签）**: 数据验证和约束规则
  - `required` - 必填
  - `min` - 最小值
  - `max` - 最大值
  - `email` - 邮箱格式
  - `url` - URL格式
  - 等等...

这样可以：
1. 职责清晰：UI 配置和验证逻辑分离
2. 复用性好：同一组件可以用不同的验证规则
3. 符合 Go 的 validate 标准库设计

### 统一的设计模式

所有组件应遵循以下模式：

```go
type ComponentName struct {
    // 配置字段
}

func (c *ComponentName) Config() interface{} {
    return c
}

func (c *ComponentName) Type() string {
    return TypeComponentName
}

func newComponentName(widgetParsed map[string]string) *ComponentName {
    component := &ComponentName{}
    // 从 widgetParsed 解析配置
    return component
}
```

### 注册到 NewWidget 函数

```go
func NewWidget(widgetType string, widgetParsed map[string]string) Widget {
    switch widgetType {
    // ... 现有组件
    case TypeNumber:
        return newNumber(widgetParsed)
    case TypeFloat:
        return newFloat(widgetParsed)
    // ... 其他组件
    }
}
```

---

## 📊 统计总结

- **已实现**: 9个基础组件 + 2个容器组件 = 11个
- **待实现（已定义）**: 5个
- **建议新增**: 14个
- **总计**: 30个组件

**当前完整度**: 11/16 (68.75%) - 需要补充已定义的5个组件才能达到100%

