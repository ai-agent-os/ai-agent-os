# æ–°ç‰ˆæœ¬ä¾èµ–åˆ†ææŠ¥å‘Š

## ğŸ“Š åˆ†ææ—¶é—´
2025-01-27

## ğŸ¯ åˆ†æç›®æ ‡
ç¡®è®¤æ–°ç‰ˆæœ¬æ¶æ„ï¼ˆ`web/src/architecture/`ï¼‰æ˜¯å¦è¿˜ä¾èµ–æ—§ç‰ˆæœ¬çš„ widgets ç³»ç»Ÿï¼ˆ`web/src/core/widgets/`ï¼‰ã€‚

## âœ… åˆ†æç»“æœ

### 1. æ–°ç‰ˆæœ¬æ¶æ„æ ¸å¿ƒä»£ç 

**ä½ç½®**ï¼š`web/src/architecture/`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **ä¸ä¾èµ–æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿ**
- âœ… ä½¿ç”¨ `widgets-v2` ç»„ä»¶ï¼ˆ`web/src/core/widgets-v2/`ï¼‰
- âœ… ä½¿ç”¨ `factories-v2` å·¥å‚ï¼ˆ`web/src/core/factories-v2/`ï¼‰
- âœ… ä½¿ç”¨ `renderers-v2` æ¸²æŸ“å™¨ï¼ˆ`web/src/core/renderers-v2/`ï¼‰

**ä¸»è¦æ–‡ä»¶**ï¼š
- `web/src/architecture/presentation/views/WorkspaceView.vue`
- `web/src/architecture/presentation/views/FormView.vue`
- `web/src/architecture/presentation/views/TableView.vue`

### 2. å…±äº«ç»„ä»¶ä¾èµ–æƒ…å†µ

#### 2.1 TableRenderer.vue
**ä½ç½®**ï¼š`web/src/components/TableRenderer.vue`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **å·²è¿ç§»åˆ°æ–°ç‰ˆæœ¬**
- âœ… ä½¿ç”¨ `widgetComponentFactory` (æ¥è‡ª `@/core/factories-v2`)
- âœ… ä½¿ç”¨ `widgets-v2` ç»„ä»¶è¿›è¡Œæ¸²æŸ“
- âœ… ä½¿ç”¨ `FormRenderer` (æ¥è‡ª `@/core/renderers-v2/FormRenderer.vue`)

**ä»£ç è¯æ®**ï¼š
```typescript
import { widgetComponentFactory } from '@/core/factories-v2'
import LinkWidget from '@/core/widgets-v2/components/LinkWidget.vue'
// ä½¿ç”¨ widgetComponentFactory.getRequestComponent() è·å–ç»„ä»¶
```

#### 2.2 FormDialog.vue
**ä½ç½®**ï¼š`web/src/components/FormDialog.vue`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **å·²è¿ç§»åˆ°æ–°ç‰ˆæœ¬**
- âœ… ä½¿ç”¨ `FormRenderer` (æ¥è‡ª `@/core/renderers-v2/FormRenderer.vue`)

**ä»£ç è¯æ®**ï¼š
```typescript
import FormRenderer from '@/core/renderers-v2/FormRenderer.vue'
```

#### 2.3 SearchInput.vue
**ä½ç½®**ï¼š`web/src/components/SearchInput.vue`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **ä¸ä¾èµ–æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿ**
- âœ… ä½¿ç”¨å·¥å…·å‡½æ•° `createSearchComponentConfig` ç”Ÿæˆé…ç½®
- âœ… ç›´æ¥ä½¿ç”¨ Element Plus ç»„ä»¶ï¼ˆ`el-input`, `el-select` ç­‰ï¼‰

**ä»£ç è¯æ®**ï¼š
```typescript
// ä½¿ç”¨å·¥å…·å‡½æ•°ç”Ÿæˆé…ç½®ï¼Œä¸å†ä¾èµ–æ—§ç‰ˆæœ¬ widgets
const inputConfig = computed(() => {
  return createSearchComponentConfig(
    props.field,
    props.searchType,
    props.functionMethod,
    props.functionRouter
  )
})
```

#### 2.4 å…¶ä»–å…±äº«ç»„ä»¶
**ä½ç½®**ï¼š`web/src/components/`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **ä¸æ¶‰åŠ widgets ç³»ç»Ÿ**
- è¿™äº›æ˜¯é€šç”¨ UI ç»„ä»¶ï¼Œä¸ä¾èµ– widgets ç³»ç»Ÿï¼š
  - `ServiceTreePanel.vue` - æœåŠ¡æ ‘é¢æ¿
  - `AppSwitcher.vue` - åº”ç”¨åˆ‡æ¢å™¨
  - `ThemeToggle.vue` - ä¸»é¢˜åˆ‡æ¢
  - `FunctionForkDialog.vue` - å‡½æ•°å…‹éš†å¯¹è¯æ¡†
  - `CommonUpload.vue` - é€šç”¨ä¸Šä¼ ç»„ä»¶ï¼ˆè¢« `RichTextWidget.vue` ä½¿ç”¨ï¼‰

### 3. widgets-v2 ç»„ä»¶ä¾èµ–

**ä½ç½®**ï¼š`web/src/core/widgets-v2/components/`

**ä¾èµ–æƒ…å†µ**ï¼š
- âœ… **ä¸ä¾èµ–æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿ**
- âœ… æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„ Vue ç»„ä»¶
- âš ï¸ `RichTextWidget.vue` ä¾èµ– `CommonUpload.vue`ï¼ˆè¿™æ˜¯é€šç”¨ç»„ä»¶ï¼Œä¸æ˜¯æ—§ç‰ˆæœ¬ widgetsï¼‰

**ä»£ç è¯æ®**ï¼š
```typescript
// RichTextWidget.vue
import CommonUpload from '@/components/CommonUpload.vue'
// è¿™æ˜¯é€šç”¨ä¸Šä¼ ç»„ä»¶ï¼Œä¸æ˜¯æ—§ç‰ˆæœ¬çš„ widgets ç³»ç»Ÿ
```

## ğŸ“‹ ä¾èµ–å…³ç³»å›¾

```
æ–°ç‰ˆæœ¬æ¶æ„ (architecture/)
â”œâ”€â”€ widgets-v2/          âœ… æ–°ç‰ˆæœ¬ç»„ä»¶
â”œâ”€â”€ factories-v2/         âœ… æ–°ç‰ˆæœ¬å·¥å‚
â”œâ”€â”€ renderers-v2/        âœ… æ–°ç‰ˆæœ¬æ¸²æŸ“å™¨
â””â”€â”€ components/          âœ… å…±äº«é€šç”¨ç»„ä»¶ï¼ˆä¸æ¶‰åŠ widgets ç³»ç»Ÿï¼‰
    â”œâ”€â”€ TableRenderer    âœ… å·²è¿ç§»åˆ° v2
    â”œâ”€â”€ FormDialog       âœ… å·²è¿ç§»åˆ° v2
    â”œâ”€â”€ SearchInput      âœ… ä¸ä¾èµ– widgets
    â”œâ”€â”€ ServiceTreePanel âœ… é€šç”¨ç»„ä»¶
    â”œâ”€â”€ AppSwitcher      âœ… é€šç”¨ç»„ä»¶
    â”œâ”€â”€ ThemeToggle      âœ… é€šç”¨ç»„ä»¶
    â”œâ”€â”€ FunctionForkDialog âœ… é€šç”¨ç»„ä»¶
    â””â”€â”€ CommonUpload     âœ… é€šç”¨ç»„ä»¶ï¼ˆè¢« RichTextWidget ä½¿ç”¨ï¼‰
```

## ğŸ¯ ç»“è®º

### âœ… æ–°ç‰ˆæœ¬å·²å®Œå…¨ç‹¬ç«‹

1. **æ–°ç‰ˆæœ¬æ¶æ„ï¼ˆ`architecture/`ï¼‰**ï¼š
   - âœ… å®Œå…¨ä¸ä¾èµ–æ—§ç‰ˆæœ¬çš„ widgets ç³»ç»Ÿ
   - âœ… ä½¿ç”¨æ–°ç‰ˆæœ¬çš„ `widgets-v2`ã€`factories-v2`ã€`renderers-v2`

2. **å…±äº«ç»„ä»¶ï¼ˆ`components/`ï¼‰**ï¼š
   - âœ… `TableRenderer` å’Œ `FormDialog` å·²è¿ç§»åˆ°æ–°ç‰ˆæœ¬
   - âœ… `SearchInput` ä¸ä¾èµ– widgets ç³»ç»Ÿ
   - âœ… å…¶ä»–ç»„ä»¶æ˜¯é€šç”¨ UI ç»„ä»¶ï¼Œä¸æ¶‰åŠ widgets ç³»ç»Ÿ

3. **ä¾èµ–çš„é€šç”¨ç»„ä»¶**ï¼š
   - âœ… `CommonUpload` æ˜¯é€šç”¨ä¸Šä¼ ç»„ä»¶ï¼Œä¸æ˜¯æ—§ç‰ˆæœ¬çš„ widgets ç³»ç»Ÿ
   - âœ… å…¶ä»–ç»„ä»¶ï¼ˆ`ServiceTreePanel`ã€`AppSwitcher` ç­‰ï¼‰æ˜¯é€šç”¨ UI ç»„ä»¶

### âœ… æ—§ç‰ˆæœ¬ widgets ç³»ç»ŸçŠ¶æ€

**æ£€æŸ¥ç»“æœ**ï¼š
- âœ… **æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿå·²å®Œå…¨ç§»é™¤**
- âœ… ä»£ç åº“ä¸­ä¸å­˜åœ¨ `web/src/core/widgets/` ç›®å½•
- âœ… ä»£ç åº“ä¸­ä¸å­˜åœ¨ `WidgetBuilder.ts` æˆ– `WidgetFactory.ts` æ–‡ä»¶
- âœ… æ²¡æœ‰ä»»ä½•ä»£ç å¯¼å…¥æˆ–ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ widgets ç³»ç»Ÿ

**éªŒè¯å‘½ä»¤ç»“æœ**ï¼š
```bash
# æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç å¯¼å…¥æ—§ç‰ˆæœ¬ widgets
grep -r "from.*@/core/widgets/" web/src
# ç»“æœï¼šNo matches found âœ…

# æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç ä½¿ç”¨ WidgetBuilder æˆ– WidgetFactory
grep -r "WidgetBuilder\|WidgetFactory" web/src
# ç»“æœï¼šä»…åœ¨ README.md ä¸­æåˆ°ï¼ˆè¯´æ˜å·²ç§»é™¤ï¼‰âœ…
```

## ğŸ“ å»ºè®®

1. **å½“å‰çŠ¶æ€**ï¼š
   - âœ… **æ–°ç‰ˆæœ¬å·²å®Œå…¨ç‹¬ç«‹ï¼Œä¸ä¾èµ–æ—§ç‰ˆæœ¬**
   - âœ… **æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿå·²å®Œå…¨ç§»é™¤**
   - âœ… å…±äº«ç»„ä»¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼ˆå®ƒä»¬ä¸æ¶‰åŠ widgets ç³»ç»Ÿï¼‰

2. **åç»­ç»´æŠ¤**ï¼š
   - âœ… ä¿æŒæ–°ç‰ˆæœ¬æ¶æ„çš„ç‹¬ç«‹æ€§
   - âœ… ç»§ç»­ä½¿ç”¨ `widgets-v2`ã€`factories-v2`ã€`renderers-v2`
   - âœ… å…±äº«ç»„ä»¶ï¼ˆå¦‚ `CommonUpload`ã€`ServiceTreePanel` ç­‰ï¼‰å¯ä»¥ç»§ç»­ä½¿ç”¨

3. **ä»£ç è´¨é‡**ï¼š
   - âœ… æ–°ç‰ˆæœ¬æ¶æ„æ¸…æ™°ï¼Œä¾èµ–å…³ç³»æ˜ç¡®
   - âœ… æ²¡æœ‰é—ç•™çš„æ—§ç‰ˆæœ¬ä»£ç 
   - âœ… ä»£ç åº“ä¿æŒæ•´æ´

## ğŸ” æ£€æŸ¥å‘½ä»¤

å¦‚æœéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ—§ç‰ˆæœ¬ widgets ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥è¿è¡Œï¼š

```bash
# æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç å¯¼å…¥æ—§ç‰ˆæœ¬ widgets
grep -r "from.*@/core/widgets/" web/src --exclude-dir=node_modules

# æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç ä½¿ç”¨ WidgetBuilder æˆ– WidgetFactory
grep -r "WidgetBuilder\|WidgetFactory" web/src --exclude-dir=node_modules
```

