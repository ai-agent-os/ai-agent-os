# table_permission æƒé™é€»è¾‘

## æ¦‚è¿°

`table_permission` æ˜¯å­—æ®µçº§åˆ«çš„æƒé™æ§åˆ¶æ ‡è¯†ï¼Œç”¨äºæ§åˆ¶å­—æ®µåœ¨ä¸åŒåœºæ™¯ä¸‹çš„æ˜¾ç¤ºå’Œç¼–è¾‘è¡Œä¸ºã€‚

**æ ¸å¿ƒåŸåˆ™**ï¼š
- ğŸ”‘ **Table åˆ—è¡¨**ï¼šåªæ˜¾ç¤º `""` å’Œ `"read"` å­—æ®µï¼ˆ`create` å’Œ `update` å­—æ®µä¸åœ¨åˆ—è¡¨ä¸­å±•ç¤ºï¼‰
- ğŸ“ **æ–°å¢è¡¨å•**ï¼šåªæ˜¾ç¤º `""` å’Œ `"create"` å­—æ®µ
- ğŸ“ **ç¼–è¾‘è¡¨å•**ï¼šåªæ˜¾ç¤º `""` å’Œ `"update"` å­—æ®µ

---

## æƒé™å€¼è¯´æ˜

| æƒé™å€¼ | å«ä¹‰ | Table åˆ—è¡¨ | æ–°å¢è¡¨å• | ç¼–è¾‘è¡¨å• |
|-------|------|-----------|---------|---------|
| `""` (ç©ºå­—ç¬¦ä¸²) | å…¨éƒ¨æƒé™ | âœ… æ˜¾ç¤º | âœ… å¯å¡«å†™ | âœ… å¯ä¿®æ”¹ |
| `"read"` | åªè¯» | âœ… æ˜¾ç¤ºï¼ˆåªè¯»ï¼‰ | âŒ ä¸æ˜¾ç¤º | âŒ ä¸æ˜¾ç¤º |
| `"create"` | ä»…æ–°å¢ | âŒ ä¸æ˜¾ç¤º | âœ… å¯å¡«å†™ | âŒ ä¸æ˜¾ç¤º |
| `"update"` | ä»…ç¼–è¾‘ | âŒ ä¸æ˜¾ç¤º | âŒ ä¸æ˜¾ç¤º | âœ… å¯ä¿®æ”¹ |

---

## å…¸å‹åº”ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šè‡ªåŠ¨ç”Ÿæˆçš„åªè¯»å­—æ®µ

**å­—æ®µ**ï¼š`id`ã€`created_at`ã€`updated_at`

```json
{
  "code": "id",
  "name": "ID",
  "table_permission": "read",
  "widget": {
    "type": "ID"
  }
}
```

**ä¸šåŠ¡é€»è¾‘**ï¼š
- âœ… åœ¨åˆ—è¡¨ä¸­å±•ç¤ºï¼ˆç”¨æˆ·éœ€è¦çœ‹åˆ° IDï¼‰
- âŒ æ–°å¢æ—¶ä¸æ˜¾ç¤ºï¼ˆåç«¯è‡ªåŠ¨ç”Ÿæˆï¼‰
- âŒ ç¼–è¾‘æ—¶ä¸æ˜¾ç¤ºï¼ˆID ä¸å¯å˜ï¼‰

**åç«¯è¡Œä¸º**ï¼š
- æ–°å¢ï¼šåç«¯è‡ªåŠ¨ç”Ÿæˆ ID
- ç¼–è¾‘ï¼šåç«¯å¿½ç•¥ ID å­—æ®µçš„ä¿®æ”¹

---

### åœºæ™¯ 2ï¼šæ™®é€šå¯ç¼–è¾‘å­—æ®µ

**å­—æ®µ**ï¼š`title`ã€`content`ã€`status`

```json
{
  "code": "title",
  "name": "æ ‡é¢˜",
  "table_permission": "",
  "widget": {
    "type": "input"
  }
}
```

**ä¸šåŠ¡é€»è¾‘**ï¼š
- âœ… åœ¨åˆ—è¡¨ä¸­å±•ç¤º
- âœ… æ–°å¢æ—¶å¯å¡«å†™
- âœ… ç¼–è¾‘æ—¶å¯ä¿®æ”¹

---

### åœºæ™¯ 3ï¼šä»…æ–°å¢æ—¶å¡«å†™çš„å­—æ®µ

**å­—æ®µ**ï¼š`password`ï¼ˆåˆå§‹å¯†ç ï¼‰

```json
{
  "code": "password",
  "name": "åˆå§‹å¯†ç ",
  "table_permission": "create",
  "widget": {
    "type": "input",
    "config": {
      "password": true
    }
  }
}
```

**ä¸šåŠ¡é€»è¾‘**ï¼š
- âŒ åœ¨åˆ—è¡¨ä¸­ä¸å±•ç¤ºï¼ˆæ•æ„Ÿå­—æ®µï¼Œä¸åœ¨åˆ—è¡¨ä¸­æ˜¾ç¤ºï¼‰
- âœ… æ–°å¢æ—¶å¿…é¡»å¡«å†™ï¼ˆè®¾ç½®åˆå§‹å¯†ç ï¼‰
- âŒ ç¼–è¾‘æ—¶ä¸æ˜¾ç¤ºï¼ˆä¿®æ”¹å¯†ç é€šè¿‡ä¸“é—¨çš„"ä¿®æ”¹å¯†ç "åŠŸèƒ½ï¼‰

**åç«¯è¡Œä¸º**ï¼š
- æ–°å¢ï¼šå¿…é¡»æä¾›å¯†ç 
- ç¼–è¾‘ï¼šä¸æ¥å—å¯†ç å­—æ®µï¼Œéœ€è¦é€šè¿‡ä¸“é—¨çš„ API ä¿®æ”¹

**å…¸å‹åœºæ™¯**ï¼š
- ç”¨æˆ·åˆå§‹å¯†ç ï¼ˆæ–°å¢æ—¶å¡«å†™ï¼Œåç»­é€šè¿‡ä¸“é—¨æ¥å£ä¿®æ”¹ï¼‰
- æ¿€æ´»ç ï¼ˆæ–°å¢æ—¶å¡«å†™ï¼Œä¸å¯ä¿®æ”¹ï¼‰
- åˆå§‹é…ç½®ï¼ˆæ–°å¢æ—¶è®¾ç½®ï¼Œåç»­ä¸å¯å˜ï¼‰

---

### åœºæ™¯ 4ï¼šä»…ç¼–è¾‘æ—¶ä¿®æ”¹çš„å­—æ®µ

**å­—æ®µ**ï¼š`audit_status`ï¼ˆå®¡æ ¸çŠ¶æ€ï¼‰

```json
{
  "code": "audit_status",
  "name": "å®¡æ ¸çŠ¶æ€",
  "table_permission": "update",
  "widget": {
    "type": "select",
    "config": {
      "options": ["å¾…å®¡æ ¸", "å·²é€šè¿‡", "å·²æ‹’ç»"]
    }
  }
}
```

**ä¸šåŠ¡é€»è¾‘**ï¼š
- âŒ åœ¨åˆ—è¡¨ä¸­ä¸å±•ç¤ºï¼ˆå¯èƒ½åœ¨å…¶ä»–ä¸“é—¨çš„å®¡æ ¸åˆ—è¡¨ä¸­å±•ç¤ºï¼‰
- âŒ æ–°å¢æ—¶ä¸æ˜¾ç¤ºï¼ˆæ–°è®°å½•é»˜è®¤ä¸º"å¾…å®¡æ ¸"ï¼‰
- âœ… ç¼–è¾‘æ—¶å¯ä¿®æ”¹ï¼ˆå®¡æ ¸å‘˜å¯ä»¥ä¿®æ”¹çŠ¶æ€ï¼‰

**åç«¯è¡Œä¸º**ï¼š
- æ–°å¢ï¼šåç«¯è‡ªåŠ¨è®¾ç½®ä¸º"å¾…å®¡æ ¸"
- ç¼–è¾‘ï¼šå…è®¸ä¿®æ”¹å®¡æ ¸çŠ¶æ€

**å…¸å‹åœºæ™¯**ï¼š
- å®¡æ ¸çŠ¶æ€ï¼ˆæ–°å¢æ—¶è‡ªåŠ¨ä¸º"å¾…å®¡æ ¸"ï¼Œå®¡æ ¸å‘˜ç¼–è¾‘æ—¶ä¿®æ”¹ï¼‰
- å‘è´§çŠ¶æ€ï¼ˆæ–°å¢è®¢å•æ—¶è‡ªåŠ¨ä¸º"å¾…å‘è´§"ï¼Œä»“åº“ç¼–è¾‘æ—¶æ›´æ–°ï¼‰
- å¤„ç†è¿›åº¦ï¼ˆæ–°å¢å·¥å•æ—¶è‡ªåŠ¨ä¸º"å¾…å¤„ç†"ï¼Œå®¢æœç¼–è¾‘æ—¶æ›´æ–°ï¼‰

---

## å‰ç«¯å®ç°è§„èŒƒ

### 1. Table åˆ—è¡¨å±•ç¤ºï¼ˆTableRendererï¼‰

```typescript
// web/src/components/TableRenderer.vue

// ğŸ”¥ å…³é”®ï¼šåªæ˜¾ç¤ºç©ºå’Œ read å­—æ®µ
const visibleFields = computed(() => {
  return props.functionData.response.filter(field => {
    const permission = field.table_permission
    // âœ… æ˜¾ç¤ºï¼šç©ºã€read
    // âŒ ä¸æ˜¾ç¤ºï¼šcreateï¼ˆåªåœ¨æ–°å¢è¡¨å•ï¼‰ã€updateï¼ˆåªåœ¨ç¼–è¾‘è¡¨å•ï¼‰
    return !permission || permission === '' || permission === 'read'
  })
})
```

**è¿‡æ»¤é€»è¾‘**ï¼š
| æƒé™å€¼ | æ˜¯å¦æ˜¾ç¤º | åŸå›  |
|-------|---------|------|
| `""` | âœ… æ˜¾ç¤º | å…¨éƒ¨æƒé™ |
| `"read"` | âœ… æ˜¾ç¤º | åªè¯»å­—æ®µï¼Œåœ¨åˆ—è¡¨ä¸­å±•ç¤º |
| `"create"` | âŒ ä¸æ˜¾ç¤º | åªåœ¨æ–°å¢è¡¨å•ä¸­å¡«å†™ï¼Œåˆ—è¡¨ä¸å±•ç¤º |
| `"update"` | âŒ ä¸æ˜¾ç¤º | åªåœ¨ç¼–è¾‘è¡¨å•ä¸­ä¿®æ”¹ï¼Œåˆ—è¡¨ä¸å±•ç¤º |

**å¯é€‰ä¼˜åŒ–**ï¼šå¯¹ `read` å­—æ®µæ·»åŠ è§†è§‰æç¤º

```typescript
// è¡¨æ ¼åˆ—å®šä¹‰
const tableColumns = computed(() => {
  return visibleFields.value.map(field => {
    return {
      prop: field.code,
      label: field.name,
      // ğŸ”¥ read å­—æ®µå¯ä»¥æ·»åŠ ç‰¹æ®Šæ ·å¼
      className: field.table_permission === 'read' ? 'readonly-column' : ''
    }
  })
})
```

```css
/* åªè¯»åˆ—çš„è§†è§‰æç¤º */
.readonly-column {
  background-color: #f5f7fa;
  color: #909399;
}
```

---

### 2. æ–°å¢è¡¨å•ï¼ˆFormDialog - create æ¨¡å¼ï¼‰

```typescript
// web/src/components/FormDialog.vue

const filteredFields = computed(() => {
  if (props.mode === 'create') {
    return props.fields.filter(field => {
      const permission = field.table_permission
      
      // âœ… æ˜¾ç¤ºï¼šç©ºã€create
      // âŒ ä¸æ˜¾ç¤ºï¼šreadã€update
      return !permission || permission === '' || permission === 'create'
    })
  }
  // ...
})
```

**è¿‡æ»¤é€»è¾‘**ï¼š
| æƒé™å€¼ | æ˜¯å¦æ˜¾ç¤º | åŸå›  |
|-------|---------|------|
| `""` | âœ… æ˜¾ç¤º | å…¨éƒ¨æƒé™ |
| `"read"` | âŒ ä¸æ˜¾ç¤º | åç«¯è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€å¡«å†™ |
| `"create"` | âœ… æ˜¾ç¤º | ä»…æ–°å¢æ—¶å¡«å†™ |
| `"update"` | âŒ ä¸æ˜¾ç¤º | ä»…ç¼–è¾‘æ—¶å¯ä¿®æ”¹ |

---

### 3. ç¼–è¾‘è¡¨å•ï¼ˆFormDialog - update æ¨¡å¼ï¼‰

```typescript
// web/src/components/FormDialog.vue

const filteredFields = computed(() => {
  if (props.mode === 'update') {
    return props.fields.filter(field => {
      const permission = field.table_permission
      
      // âœ… æ˜¾ç¤ºï¼šç©ºã€update
      // âŒ ä¸æ˜¾ç¤ºï¼šreadã€create
      return !permission || permission === '' || permission === 'update'
    })
  }
  // ...
})
```

**è¿‡æ»¤é€»è¾‘**ï¼š
| æƒé™å€¼ | æ˜¯å¦æ˜¾ç¤º | åŸå›  |
|-------|---------|------|
| `""` | âœ… æ˜¾ç¤º | å…¨éƒ¨æƒé™ |
| `"read"` | âŒ ä¸æ˜¾ç¤º | åªè¯»å­—æ®µï¼Œä¸å¯ä¿®æ”¹ |
| `"create"` | âŒ ä¸æ˜¾ç¤º | ä»…æ–°å¢æ—¶å¡«å†™ï¼Œä¸å¯ä¿®æ”¹ |
| `"update"` | âœ… æ˜¾ç¤º | ä»…ç¼–è¾‘æ—¶å¯ä¿®æ”¹ |

---

### 4. Form å‡½æ•°è¡¨å•ï¼ˆFormRendererï¼‰

**é—®é¢˜**ï¼šForm å‡½æ•°ï¼ˆé Tableï¼‰æ²¡æœ‰"æ–°å¢"å’Œ"ç¼–è¾‘"çš„åŒºåˆ†ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ

**æ–¹æ¡ˆ 1**ï¼šé»˜è®¤ä¸º"æ–°å¢"æ¨¡å¼ï¼ˆæ¨èï¼‰

```typescript
// web/src/core/renderers/FormRenderer.vue

const renderableFields = computed(() => {
  return props.functionDetail.request.filter(field => {
    const permission = field.table_permission
    
    // ğŸ”¥ é»˜è®¤ä¸º"æ–°å¢"æ¨¡å¼
    // âœ… æ˜¾ç¤ºï¼šç©ºã€create
    // âŒ ä¸æ˜¾ç¤ºï¼šreadã€update
    return !permission || permission === '' || permission === 'create'
  })
})
```

**æ–¹æ¡ˆ 2**ï¼šæ·»åŠ  `mode` å‚æ•°ï¼ˆæœªæ¥æ‰©å±•ï¼‰

```typescript
// å¦‚æœæœªæ¥éœ€è¦ Form å‡½æ•°ä¹Ÿæ”¯æŒç¼–è¾‘æ¨¡å¼
const props = defineProps<{
  functionDetail: any
  mode?: 'create' | 'update'  // å¯é€‰å‚æ•°ï¼Œé»˜è®¤ create
}>()

const renderableFields = computed(() => {
  const mode = props.mode || 'create'
  
  return props.functionDetail.request.filter(field => {
    const permission = field.table_permission
    
    if (mode === 'create') {
      return !permission || permission === '' || permission === 'create'
    } else {
      return !permission || permission === '' || permission === 'update'
    }
  })
})
```

---

## åç«¯æ•°æ®å¥‘çº¦

### è¯·æ±‚å­—æ®µï¼ˆrequestï¼‰

åç«¯åº”å¿½ç•¥ä»¥ä¸‹æƒ…å†µçš„å­—æ®µï¼š

| æƒé™å€¼ | æ–°å¢è¯·æ±‚ | ç¼–è¾‘è¯·æ±‚ |
|-------|---------|---------|
| `"read"` | âœ… å¿½ç•¥ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ | âœ… å¿½ç•¥ï¼ˆä¸å¯ä¿®æ”¹ï¼‰ |
| `"create"` | âœ… æ¥å— | âœ… å¿½ç•¥ï¼ˆä¸å¯ä¿®æ”¹ï¼‰ |
| `"update"` | âœ… å¿½ç•¥ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ | âœ… æ¥å— |

### å“åº”å­—æ®µï¼ˆresponseï¼‰

å“åº”æ•°æ®åº”åŒ…å«æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬ `read`ã€`create`ã€`update` æƒé™çš„å­—æ®µã€‚

**ç¤ºä¾‹**ï¼š
```json
{
  "id": 123,               // read
  "title": "æµ‹è¯•æ ‡é¢˜",      // ç©ºï¼ˆå…¨éƒ¨æƒé™ï¼‰
  "created_at": 1698825600000,  // read
  "password": "******",    // createï¼ˆä¸è¿”å›æ˜æ–‡ï¼‰
  "audit_status": "å·²é€šè¿‡"  // update
}
```

---

## æ€»ç»“

### æ ¸å¿ƒåŸåˆ™

1. **Table åˆ—è¡¨**ï¼šâœ… åªæ˜¾ç¤º `""` å’Œ `"read"` å­—æ®µï¼ˆ`create` å’Œ `update` ä¸åœ¨åˆ—è¡¨ä¸­å±•ç¤ºï¼‰
2. **æ–°å¢è¡¨å•**ï¼šâœ… æ˜¾ç¤º `""` å’Œ `"create"` å­—æ®µ
3. **ç¼–è¾‘è¡¨å•**ï¼šâœ… æ˜¾ç¤º `""` å’Œ `"update"` å­—æ®µ
4. **Form å‡½æ•°**ï¼šâœ… é»˜è®¤ä¸ºæ–°å¢æ¨¡å¼ï¼ˆæ˜¾ç¤º `""` å’Œ `"create"` å­—æ®µï¼‰

### å®ç°æ£€æŸ¥æ¸…å•

- [x] **FormDialog**ï¼šâœ… å·²æ­£ç¡®å®ç°ï¼ˆç¬¬ 71-94 è¡Œï¼‰
- [x] **TableRenderer**ï¼šâœ… å·²æ­£ç¡®å®ç°ï¼ˆç¬¬ 190-202 è¡Œï¼Œåªæ˜¾ç¤ºç©ºå’Œ readï¼‰
- [x] **FormRenderer**ï¼šâœ… å·²æ­£ç¡®å®ç°ï¼ˆç¬¬ 169-181 è¡Œï¼Œé»˜è®¤æ–°å¢æ¨¡å¼ï¼‰
- [ ] **æ ·å¼ä¼˜åŒ–**ï¼šå¯é€‰æ·»åŠ  `read` å­—æ®µçš„è§†è§‰æç¤º

### æµ‹è¯•åœºæ™¯

#### æµ‹è¯• 1ï¼š`read` å­—æ®µï¼ˆå¦‚ `id`ï¼‰
- âœ… åˆ—è¡¨ä¸­æ˜¾ç¤º
- âœ… æ–°å¢è¡¨å•ä¸­ä¸æ˜¾ç¤º
- âœ… ç¼–è¾‘è¡¨å•ä¸­ä¸æ˜¾ç¤º

#### æµ‹è¯• 2ï¼š`create` å­—æ®µï¼ˆå¦‚ `password`ï¼‰
- âœ… åˆ—è¡¨ä¸­ä¸æ˜¾ç¤º
- âœ… æ–°å¢è¡¨å•ä¸­æ˜¾ç¤º
- âœ… ç¼–è¾‘è¡¨å•ä¸­ä¸æ˜¾ç¤º

#### æµ‹è¯• 3ï¼š`update` å­—æ®µï¼ˆå¦‚ `audit_status`ï¼‰
- âœ… åˆ—è¡¨ä¸­ä¸æ˜¾ç¤º
- âœ… æ–°å¢è¡¨å•ä¸­ä¸æ˜¾ç¤º
- âœ… ç¼–è¾‘è¡¨å•ä¸­æ˜¾ç¤º

#### æµ‹è¯• 4ï¼šç©ºå­—ç¬¦ä¸²å­—æ®µï¼ˆå¦‚ `title`ï¼‰
- âœ… åˆ—è¡¨ä¸­æ˜¾ç¤º
- âœ… æ–°å¢è¡¨å•ä¸­æ˜¾ç¤º
- âœ… ç¼–è¾‘è¡¨å•ä¸­æ˜¾ç¤º

---

## é™„å½•ï¼šæƒé™å€¼çš„è¯­ä¹‰ç†è§£

### ä¸ºä»€ä¹ˆæ˜¯ `read` è€Œä¸æ˜¯ `readonly`ï¼Ÿ

**è®¾è®¡æ€è·¯**ï¼š`table_permission` æè¿°çš„æ˜¯"è¯¥å­—æ®µåœ¨å“ªäº›æ“ä½œä¸­æœ‰æƒé™"ã€‚

- `"read"` = åªæœ‰"è¯»å–"æƒé™ï¼ˆåªåœ¨åˆ—è¡¨ä¸­å±•ç¤ºï¼Œä¸å¯åœ¨è¡¨å•ä¸­å¡«å†™/ä¿®æ”¹ï¼‰
- `"create"` = åªæœ‰"åˆ›å»º"æƒé™ï¼ˆåªåœ¨æ–°å¢è¡¨å•ä¸­å¡«å†™ï¼‰
- `"update"` = åªæœ‰"æ›´æ–°"æƒé™ï¼ˆåªåœ¨ç¼–è¾‘è¡¨å•ä¸­ä¿®æ”¹ï¼‰
- `""` = å…¨éƒ¨æƒé™ï¼ˆè¯»å– + åˆ›å»º + æ›´æ–°ï¼‰

### ä¸ºä»€ä¹ˆ `read` å­—æ®µåœ¨åˆ—è¡¨ä¸­æ˜¾ç¤ºï¼Ÿ

**ä¸šåŠ¡éœ€æ±‚**ï¼š
- ç”¨æˆ·éœ€è¦çœ‹åˆ° `id`ã€`created_at` ç­‰ä¿¡æ¯ï¼ˆè™½ç„¶ä¸èƒ½ä¿®æ”¹ï¼‰
- åˆ—è¡¨å±•ç¤ºçš„æ˜¯"æ•°æ®çš„å®Œæ•´è§†å›¾"
- è¡¨å•å¡«å†™çš„æ˜¯"ç”¨æˆ·å¯ä»¥æ“ä½œçš„å­—æ®µ"

**åˆ†ç¦»å…³æ³¨ç‚¹**ï¼š
- åˆ—è¡¨ = æ•°æ®å±•ç¤ºï¼ˆWhat you can seeï¼‰
- è¡¨å• = æ•°æ®æ“ä½œï¼ˆWhat you can doï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2024-11-02  
**ç»´æŠ¤è€…**ï¼šAI Agent OS Team

