definitions:
  dto.AddFunctionsReq:
    properties:
      agent_id:
        description: 智能体ID
        example: 1
        type: integer
      async:
        description: '是否异步处理（true: 异步，通过回调通知；false: 同步，直接返回结果）'
        example: false
        type: boolean
      code:
        description: 生成的代码内容（原始代码，已废弃，保留用于兼容）
        example: "package main\n\nfunc main() {\n\t// 生成的代码\n}"
        type: string
      file_name:
        description: 处理后的结构化数据（agent-server 处理后的结果）
        example: crm_ticket
        type: string
      message_id:
        description: 消息ID（关联到 AgentChatMessage.ID）
        example: 1
        type: integer
      record_id:
        description: function_gen 记录ID
        example: 1
        type: integer
      source_code:
        description: 处理后的源代码（从 Markdown 中提取）
        example: package...
        type: string
      tree_id:
        description: 服务目录ID
        example: 629
        type: integer
      user:
        description: 用户标识
        example: beiluo
        type: string
    type: object
  dto.AddFunctionsResp:
    properties:
      app_code:
        description: 应用代码
        example: myapp
        type: string
      app_id:
        description: 应用ID
        example: 1
        type: integer
      error:
        description: 错误信息（如果失败）
        example: ""
        type: string
      full_group_codes:
        description: 生成的函数组代码列表
        example:
        - '["/user/app/function"]'
        items:
          type: string
        type: array
      success:
        description: 是否成功
        example: true
        type: boolean
    type: object
  dto.ApiInfo:
    properties:
      added_version:
        description: API首次添加的版本
        type: string
      app:
        type: string
      callback:
        items:
          type: string
        type: array
      code:
        type: string
      create_tables:
        items:
          type: string
        type: array
      desc:
        type: string
      full_code_path:
        type: string
      function_group_code:
        type: string
      function_group_name:
        type: string
      method:
        type: string
      name:
        type: string
      request:
        items:
          $ref: '#/definitions/widget.Field'
        type: array
      response:
        items:
          $ref: '#/definitions/widget.Field'
        type: array
      router:
        type: string
      source_code:
        type: string
      source_code_file_path:
        type: string
      tags:
        items:
          type: string
        type: array
      template_type:
        type: string
      update_versions:
        description: API更新过的版本列表
        items:
          type: string
        type: array
      user:
        type: string
    type: object
  dto.AppVersionUpdateInfo:
    properties:
      app_version:
        description: 应用版本号
        type: string
      directory_changes:
        description: 该版本下的所有目录变更（数组）
        items:
          $ref: '#/definitions/dto.DirectoryChangeInfo'
        type: array
    type: object
  dto.CopyDirectoryReq:
    properties:
      source_directory_path:
        description: 源目录完整路径
        example: /luobei/app_a/hr
        type: string
      target_app_id:
        description: 目标应用ID
        example: 123
        type: integer
      target_directory_path:
        description: 目标目录完整路径
        example: /luobei/app_b/hr
        type: string
    required:
    - source_directory_path
    - target_app_id
    - target_directory_path
    type: object
  dto.CopyDirectoryResp:
    properties:
      directory_count:
        description: 复制的目录数
        example: 3
        type: integer
      file_count:
        description: 复制的文件数
        example: 15
        type: integer
      message:
        description: 响应消息
        example: 复制目录成功，共复制 3 个目录，15 个文件
        type: string
    type: object
  dto.CreateAppReq:
    properties:
      code:
        description: 应用名
        example: myapp
        type: string
      name:
        description: 应用名
        example: 腾讯oa系统
        type: string
    required:
    - code
    - name
    type: object
  dto.CreateAppResp:
    properties:
      app:
        description: 应用名
        example: myapp
        type: string
      app_dir:
        description: 应用目录
        example: namespace/beiluo/myapp
        type: string
      user:
        description: 用户名
        example: beiluo
        type: string
    type: object
  dto.CreateServiceTreeReq:
    properties:
      app:
        description: 应用名
        example: myapp
        type: string
      code:
        description: 服务目录代码
        example: user
        type: string
      description:
        description: 描述
        example: 用户相关的API接口
        type: string
      name:
        description: 服务目录名称
        example: 用户管理
        type: string
      parent_id:
        description: 父目录ID，0表示根目录
        example: 0
        type: integer
      tags:
        description: 标签
        example: user,management
        type: string
      user:
        description: 用户名
        example: beiluo
        type: string
    required:
    - app
    - code
    - name
    - user
    type: object
  dto.CreateServiceTreeResp:
    properties:
      app_id:
        description: 应用ID
        example: 1
        type: integer
      code:
        description: 服务目录代码
        example: user
        type: string
      description:
        description: 描述
        example: 用户相关的API接口
        type: string
      full_code_path:
        description: 完整代码路径
        example: /beiluo/myapp/user
        type: string
      id:
        description: 服务目录ID
        example: 1
        type: integer
      name:
        description: 服务目录名称
        example: 用户管理
        type: string
      parent_id:
        description: 父目录ID
        example: 0
        type: integer
      ref_id:
        description: 引用ID：指向真实资源的ID，如果是package类型指向package的ID，如果是function类型指向function的ID
        example: 0
        type: integer
      status:
        description: '状态: enabled(启用), disabled(禁用)'
        example: enabled
        type: string
      tags:
        description: 标签
        example: user,management
        type: string
      type:
        description: '节点类型: package(服务目录/包), function(函数/文件), api(API接口), service(服务),
          module(模块)'
        example: package
        type: string
      version:
        description: 节点当前版本号（如 v1, v2），package类型表示目录版本，function类型表示函数版本等
        example: v1
        type: string
      version_num:
        description: 节点当前版本号（数字部分）
        example: 1
        type: integer
    type: object
  dto.DeleteAppResp:
    properties:
      app:
        description: 应用名
        example: myapp
        type: string
      user:
        description: 租户名
        example: beiluo
        type: string
    type: object
  dto.DeleteServiceTreeReq:
    properties:
      id:
        description: 服务目录ID
        example: 1
        type: integer
    required:
    - id
    type: object
  dto.DiffData:
    properties:
      add:
        description: 新增的API
        items:
          $ref: '#/definitions/dto.ApiInfo'
        type: array
      delete:
        description: 删除的API
        items:
          $ref: '#/definitions/dto.ApiInfo'
        type: array
      update:
        description: 修改的API
        items:
          $ref: '#/definitions/dto.ApiInfo'
        type: array
    type: object
  dto.DirectoryChangeInfo:
    properties:
      added_apis:
        description: 新增的API摘要列表
        example: '[]'
        type: string
      added_count:
        description: 新增API数量
        type: integer
      app_version:
        description: 应用版本号（目录视角时使用）
        type: string
      app_version_num:
        description: 应用版本号（数字部分，目录视角时使用）
        type: integer
      change_description:
        description: 变更描述（大模型输出）
        type: string
      created_at:
        description: 创建时间
        type: string
      deleted_apis:
        description: 删除的API摘要列表
        example: '[]'
        type: string
      deleted_count:
        description: 删除API数量
        type: integer
      dir_version:
        description: 目录版本号
        type: string
      dir_version_num:
        description: 目录版本号（数字部分）
        type: integer
      directory_desc:
        description: 目录描述
        type: string
      directory_name:
        description: 目录名称
        type: string
      duration:
        description: 变更耗时（毫秒）
        type: integer
      full_code_path:
        description: 目录完整路径
        type: string
      git_commit_hash:
        description: Git 提交哈希（用于回滚）
        type: string
      requirement:
        description: 变更需求（用户输入）
        type: string
      summary:
        description: 变更摘要（详情）
        type: string
      updated_apis:
        description: 更新的API摘要列表
        example: '[]'
        type: string
      updated_by:
        description: 更新人
        type: string
      updated_count:
        description: 更新API数量
        type: integer
    type: object
  dto.FunctionInfo:
    properties:
      app_id:
        description: 应用ID
        example: 1
        type: integer
      callbacks:
        description: 回调函数
        example: onCreate,onUpdate
        type: string
      create_tables:
        description: 创建的表
        example: users,orders
        type: string
      created_at:
        description: 创建时间
        example: "2024-01-01T00:00:00Z"
        type: string
      description:
        description: 函数描述（从 ServiceTree 获取）
        example: 用于管理工单的创建、更新、删除等功能
        type: string
      has_config:
        description: 是否有配置
        example: true
        type: boolean
      id:
        description: 函数ID
        example: 1
        type: integer
      method:
        description: HTTP方法
        example: GET
        type: string
      name:
        description: 函数名称（从 ServiceTree 获取）
        example: 工单管理
        type: string
      router:
        description: 路由路径
        example: /users
        type: string
      template_type:
        description: 模板类型
        example: default
        type: string
      tree_id:
        description: 服务目录ID
        example: 1
        type: integer
      updated_at:
        description: 更新时间
        example: "2024-01-01T00:00:00Z"
        type: string
    type: object
  dto.GetAppVersionUpdateHistoryResp:
    properties:
      app_id:
        description: 应用ID
        type: integer
      app_version:
        description: 应用版本号（如果为空，表示返回所有版本）
        type: string
      versions:
        description: 版本列表（二维数组：第一层是版本，第二层是目录变更）
        items:
          $ref: '#/definitions/dto.AppVersionUpdateInfo'
        type: array
    type: object
  dto.GetAppsResp:
    properties:
      items: {}
      page:
        type: integer
      page_size:
        type: integer
      total_count:
        type: integer
    type: object
  dto.GetDirectoryUpdateHistoryResp:
    properties:
      app_id:
        description: 应用ID
        type: integer
      directory_changes:
        description: 目录变更历史列表
        items:
          $ref: '#/definitions/dto.DirectoryChangeInfo'
        type: array
      full_code_path:
        description: 目录完整路径
        type: string
      paginated:
        allOf:
        - $ref: '#/definitions/dto.PaginatedInfo'
        description: 分页信息
    type: object
  dto.GetFormOperateLogsResp:
    properties:
      logs:
        description: 日志列表
      page:
        description: 当前页码
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
    type: object
  dto.GetFunctionResp:
    properties:
      app_id:
        description: 应用ID
        example: 1
        type: integer
      callbacks:
        description: 回调函数
        example: onCreate,onUpdate
        type: string
      create_tables:
        description: 创建的表
        example: users,orders
        type: string
      created_at:
        description: 创建时间
        example: "2024-01-01T00:00:00Z"
        type: string
      full_code_path:
        example: /beiluo/testapi18/crm/crm_ticket
        type: string
      has_config:
        description: 是否有配置
        example: true
        type: boolean
      id:
        description: 函数ID
        example: 1
        type: integer
      method:
        description: HTTP方法
        example: GET
        type: string
      request:
        description: 请求配置（JSON对象）
      response:
        description: 响应配置（JSON对象）
      router:
        description: 路由路径
        example: /crm/crm_ticket
        type: string
      template_type:
        description: 模板类型
        example: default
        type: string
      tree_id:
        description: 服务目录ID
        example: 1
        type: integer
      updated_at:
        description: 更新时间
        example: "2024-01-01T00:00:00Z"
        type: string
    type: object
  dto.GetFunctionsByAppResp:
    properties:
      functions:
        description: 函数列表
        items:
          $ref: '#/definitions/dto.FunctionInfo'
        type: array
    type: object
  dto.GetServiceTreeResp:
    properties:
      app_id:
        description: 应用ID
        example: 1
        type: integer
      children:
        description: 子目录列表
        items:
          $ref: '#/definitions/dto.GetServiceTreeResp'
        type: array
      code:
        description: 服务目录代码
        example: user
        type: string
      description:
        description: 描述
        example: 用户相关的API接口
        type: string
      full_code_path:
        description: 完整代码路径
        example: /beiluo/myapp/user
        type: string
      full_group_code:
        description: 完整函数组代码：{full_path}/{group_code}，与 source_code.full_group_code
          对齐
        type: string
      group_name:
        description: 组名称
        type: string
      id:
        description: 服务目录ID
        example: 1
        type: integer
      name:
        description: 服务目录名称
        example: 用户管理
        type: string
      parent_id:
        description: 父目录ID
        example: 0
        type: integer
      ref_id:
        description: 引用ID：指向真实资源的ID，如果是package类型指向package的ID，如果是function类型指向function的ID
        example: 0
        type: integer
      tags:
        description: 标签
        example: user,management
        type: string
      template_type:
        description: 模板类型（函数的类型，如 form、table）
        example: form
        type: string
      type:
        description: '节点类型: package(服务目录/包), function(函数/文件), api(API接口), service(服务),
          module(模块)'
        example: package
        type: string
      version:
        description: 节点当前版本号（如 v1, v2），package类型表示目录版本，function类型表示函数版本等
        example: v1
        type: string
      version_num:
        description: 节点当前版本号（数字部分）
        example: 1
        type: integer
    type: object
  dto.GetTableOperateLogsResp:
    properties:
      logs:
        description: 日志列表
      page:
        description: 当前页码
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
    type: object
  dto.GetUsersByUsernamesReq:
    properties:
      usernames:
        description: 用户名列表，最多100个
        example:
        - '["user1"'
        - '"user2"]'
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
    required:
    - usernames
    type: object
  dto.GetUsersByUsernamesResp:
    properties:
      users:
        description: 用户列表
        items:
          $ref: '#/definitions/dto.UserInfo'
        type: array
    type: object
  dto.LoginReq:
    properties:
      password:
        description: 密码
        example: "123456"
        type: string
      remember:
        description: 记住我（延长Refresh Token有效期）
        example: false
        type: boolean
      username:
        description: 用户名
        example: beiluo
        type: string
    required:
    - password
    - username
    type: object
  dto.LoginResp:
    properties:
      refresh_token:
        description: 刷新Token
        example: refresh_eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      token:
        description: JWT Token
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      user:
        allOf:
        - $ref: '#/definitions/dto.UserInfo'
        description: 用户信息
    type: object
  dto.LogoutReq:
    properties:
      token:
        description: JWT Token
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    required:
    - token
    type: object
  dto.LogoutResp:
    type: object
  dto.PaginatedInfo:
    properties:
      current_page:
        description: 当前页码
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total_count:
        description: 总数据量
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  dto.PublishDirectoryToHubReq:
    properties:
      category:
        description: 分类
        type: string
      description:
        description: 目录描述
        type: string
      name:
        description: 目录名称
        type: string
      service_fee_enterprise:
        description: 企业用户服务费
        type: number
      service_fee_personal:
        description: 个人用户服务费
        type: number
      source_app:
        description: 源应用
        type: string
      source_directory_path:
        description: 源目录完整路径
        type: string
      source_user:
        description: 源用户
        type: string
      tags:
        description: 标签
        items:
          type: string
        type: array
    required:
    - name
    - source_app
    - source_directory_path
    - source_user
    type: object
  dto.PublishDirectoryToHubResp:
    properties:
      directory_count:
        description: 包含的子目录数量
        type: integer
      file_count:
        description: 包含的文件数量
        type: integer
      hub_directory_id:
        type: integer
      hub_directory_url:
        type: string
    type: object
  dto.QueryUserResp:
    properties:
      user:
        allOf:
        - $ref: '#/definitions/dto.UserInfo'
        description: 用户信息
    type: object
  dto.RefreshTokenReq:
    properties:
      refresh_token:
        description: 刷新Token
        example: refresh_eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    required:
    - refresh_token
    type: object
  dto.RefreshTokenResp:
    properties:
      refresh_token:
        description: 新的Refresh Token
        example: refresh_eyJhbGciOiJIUzI1NiIsInR0cCI6IkpXVCJ9...
        type: string
      token:
        description: 新的JWT Token
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  dto.RegisterReq:
    properties:
      code:
        description: 验证码
        example: "123456"
        type: string
      email:
        description: 邮箱
        example: beiluo@example.com
        type: string
      password:
        description: 密码
        example: "123456"
        minLength: 6
        type: string
      username:
        description: 用户名
        example: beiluo
        maxLength: 20
        minLength: 3
        type: string
    required:
    - code
    - email
    - password
    - username
    type: object
  dto.RegisterResp:
    properties:
      user_id:
        description: 用户ID
        example: 1
        type: integer
    type: object
  dto.RequestAppResp:
    properties:
      err_code:
        description: 0 是正常，>0 是系统错误，<0 是业务错误，业务错误用户自己处理，系统错误需要考虑用ai来分析代码是哪里出了问题
        example: 0
        type: integer
      error:
        description: 错误信息
        example: 应用内部错误
        type: string
      result:
        description: 结果
      trace_id:
        description: 追踪ID
        example: req-123456
        type: string
      version:
        example: v1
        type: string
    type: object
  dto.SearchUsersFuzzyResp:
    properties:
      users:
        description: 用户列表
        items:
          $ref: '#/definitions/dto.UserInfo'
        type: array
    type: object
  dto.SendEmailCodeReq:
    properties:
      email:
        description: 邮箱地址
        example: user@example.com
        type: string
    required:
    - email
    type: object
  dto.SendEmailCodeResp:
    type: object
  dto.UpdateAppResp:
    properties:
      app:
        description: 应用名
        example: myapp
        type: string
      diff:
        allOf:
        - $ref: '#/definitions/dto.DiffData'
        description: API diff 信息
      error:
        description: 回调过程中的错误信息
        type: string
      git_commit_hash:
        description: Git 提交哈希（用于回滚）
        type: string
      new_version:
        description: 新版本号
        example: v2
        type: string
      old_version:
        description: 旧版本号
        example: v1
        type: string
      user:
        description: 用户名
        example: beiluo
        type: string
    type: object
  dto.UpdateServiceTreeReq:
    properties:
      code:
        description: 服务目录代码
        example: user
        type: string
      description:
        description: 描述
        example: 用户相关的API接口
        type: string
      id:
        description: 服务目录ID
        example: 1
        type: integer
      name:
        description: 服务目录名称
        example: 用户管理
        type: string
      tags:
        description: 标签
        example: user,management
        type: string
    required:
    - id
    type: object
  dto.UpdateUserReq:
    properties:
      avatar:
        description: 头像URL（可选，传值则更新，不传则不更新）
        example: https://avatar.com/1.jpg
        type: string
      gender:
        description: '性别（可选，传值则更新，不传则不更新）: male(男), female(女), other(其他)'
        example: male
        type: string
      nickname:
        description: 昵称（可选，传值则更新，不传则不更新）
        example: 北落
        type: string
      signature:
        description: 个人签名/简介（可选，传值则更新，不传则不更新）
        example: 这个人很懒，什么都没有留下
        type: string
    type: object
  dto.UpdateUserResp:
    properties:
      user:
        allOf:
        - $ref: '#/definitions/dto.UserInfo'
        description: 更新后的用户信息
    type: object
  dto.UserInfo:
    properties:
      avatar:
        description: 头像
        example: https://avatar.com/1.jpg
        type: string
      created_at:
        description: 创建时间
        example: "2024-01-01T00:00:00Z"
        type: string
      email:
        description: 邮箱
        example: beiluo@example.com
        type: string
      email_verified:
        description: 邮箱是否已验证
        example: true
        type: boolean
      gender:
        description: '性别: male(男), female(女), other(其他), 空字符串表示未设置'
        example: male
        type: string
      id:
        description: 用户ID
        example: 1
        type: integer
      nickname:
        description: 昵称
        example: 北落
        type: string
      register_type:
        description: 注册方式
        example: email
        type: string
      signature:
        description: 个人签名/简介
        example: 这个人很懒，什么都没有留下
        type: string
      status:
        description: '用户状态: pending(待邮箱验证), active(已激活)'
        example: active
        type: string
      username:
        description: 用户名
        example: beiluo
        type: string
    type: object
  license.Features:
    properties:
      approval:
        description: 审批流程
        type: boolean
      change_log:
        description: 变更日志
        type: boolean
      config_management:
        description: 配置管理
        type: boolean
      notification:
        description: 通知中心
        type: boolean
      operate_log:
        description: 操作日志
        type: boolean
      organization:
        description: 组织架构
        type: boolean
      permission:
        description: 权限管理
        type: boolean
      recycle_bin:
        description: 回收站
        type: boolean
      scheduled_task:
        description: 定时任务
        type: boolean
      workflow:
        description: 工作流
        type: boolean
    type: object
  service.LicenseStatus:
    properties:
      customer:
        description: 客户名称（可选）
        type: string
      description:
        description: License 描述（可选）
        type: string
      edition:
        description: 版本类型：community, professional, enterprise, flagship
        type: string
      expires_at:
        description: 过期时间（可选）
        type: string
      features:
        allOf:
        - $ref: '#/definitions/license.Features'
        description: 功能开关（可选）
      is_community:
        description: 是否为社区版
        type: boolean
      is_valid:
        description: License 是否有效
        type: boolean
    type: object
  widget.Field:
    properties:
      callbacks:
        description: 字段级别的回调，如 ['OnSelectFuzzy']
        items:
          type: string
        type: array
      children:
        description: 嵌套字段（用于 list/struct 类型）
        items:
          $ref: '#/definitions/widget.Field'
        type: array
      code:
        description: 从json标签里解析，必需字段
        type: string
      data:
        allOf:
        - $ref: '#/definitions/widget.FieldData'
        description: 字段数据类型信息
      depend_on:
        description: 依赖的字段 code，当依赖字段值变化时，该字段会被清空
        type: string
      desc:
        description: 字段描述，用于 placeholder 等
        type: string
      field_name:
        description: Go 字段名，用于验证规则中的字段引用（如 required_if=MemberType vip）
        type: string
      name:
        description: 必需字段
        type: string
      search:
        description: 搜索类型，如 "like", "eq", "in" 等
        type: string
      table_permission:
        description: 表格权限：read,update,create
        type: string
      validation:
        description: 验证规则，完全照搬 github.com/go-playground/validator/v10
        type: string
      widget:
        properties:
          config:
            description: 组件配置，可以为空
          type:
            description: 组件类型，必需
            type: string
        type: object
    type: object
  widget.FieldData:
    properties:
      example:
        description: 示例数据，如 "10", "紧急" 等，方便前端展示示例
        type: string
      format:
        description: 格式化类型，默认不格式化，特殊场景可格式化成 csv/markdown/json/yaml/html 等
        type: string
      type:
        description: 数据类型（string/int/float/bool等），建议保留用于类型判断
        type: string
    type: object
externalDocs:
  description: OpenAPI
  url: https://swagger.io/resources/open-api/
host: localhost:9090
info:
  contact:
    email: support@swagger.io
    name: API Support
    url: http://www.swagger.io/support
  description: AI Agent OS 应用管理平台 API 文档
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: AI Agent OS API
  version: "1.0"
paths:
  /api/v1/app/create:
    post:
      consumes:
      - application/json
      description: 创建一个新的应用实例。租户用户（应用所有者）从请求体获取，请求用户（实际发起请求的用户）从请求头获取。租户用户决定应用的所有权，请求用户用于审计追踪。
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 创建应用请求，包含应用名（租户用户通过 header 传递）
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CreateAppReq'
      produces:
      - application/json
      responses:
        "200":
          description: 创建成功
          schema:
            $ref: '#/definitions/dto.CreateAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 创建应用
      tags:
      - 应用管理
  /api/v1/app/delete/{app}:
    delete:
      consumes:
      - application/json
      description: 删除应用及其所有相关资源
      parameters:
      - description: 应用名
        in: path
        name: app
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 删除成功
          schema:
            $ref: '#/definitions/dto.DeleteAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 删除应用
      tags:
      - 应用管理
  /api/v1/app/list:
    get:
      consumes:
      - application/json
      description: 获取当前用户的所有应用列表（支持分页和搜索）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - default: 1
        description: 页码，默认为1
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量，默认为10
        in: query
        name: page_size
        type: integer
      - description: 搜索关键词（支持按应用名称或代码搜索）
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/dto.GetAppsResp'
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取应用列表
      tags:
      - 应用管理
  /api/v1/app/update/{app}:
    post:
      consumes:
      - application/json
      description: 更新应用代码并重新编译部署
      parameters:
      - description: 应用名
        in: path
        name: app
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            $ref: '#/definitions/dto.UpdateAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 更新应用
      tags:
      - 应用管理
  /api/v1/auth/login:
    post:
      consumes:
      - application/json
      description: 使用用户名和密码登录
      parameters:
      - description: 登录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.LoginReq'
      produces:
      - application/json
      responses:
        "200":
          description: 登录成功
          schema:
            $ref: '#/definitions/dto.LoginResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 用户名或密码错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 用户登录
      tags:
      - 认证管理
  /api/v1/auth/logout:
    post:
      consumes:
      - application/json
      description: 用户登出，使Token失效
      parameters:
      - description: 登出请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.LogoutReq'
      produces:
      - application/json
      responses:
        "200":
          description: 登出成功
          schema:
            $ref: '#/definitions/dto.LogoutResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 用户登出
      tags:
      - 认证管理
  /api/v1/auth/refresh:
    post:
      consumes:
      - application/json
      description: 使用RefreshToken刷新JWT Token
      parameters:
      - description: 刷新Token请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RefreshTokenReq'
      produces:
      - application/json
      responses:
        "200":
          description: 刷新成功
          schema:
            $ref: '#/definitions/dto.RefreshTokenResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: RefreshToken无效
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 刷新Token
      tags:
      - 认证管理
  /api/v1/auth/register:
    post:
      consumes:
      - application/json
      description: 使用邮箱验证码注册新用户
      parameters:
      - description: 注册请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RegisterReq'
      produces:
      - application/json
      responses:
        "200":
          description: 注册成功
          schema:
            $ref: '#/definitions/dto.RegisterResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 用户注册
      tags:
      - 认证管理
  /api/v1/auth/send_email_code:
    post:
      consumes:
      - application/json
      description: 向指定邮箱发送验证码，用于注册验证
      parameters:
      - description: 发送验证码请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.SendEmailCodeReq'
      produces:
      - application/json
      responses:
        "200":
          description: 发送成功
          schema:
            $ref: '#/definitions/dto.SendEmailCodeResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 发送邮箱验证码
      tags:
      - 认证管理
  /api/v1/callback/{router}:
    post:
      consumes:
      - application/json
      - application/x-www-form-urlencoded
      - multipart/form-data
      - text/plain
      description: 接收外部系统的回调请求并转发到应用内部的 callback 路由。路径格式：/api/v1/callback/*router?_type=回调类型
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 回调路由路径，格式：/{router}，例如：/api/v1/callback/*router?_type=回调类型
        in: path
        name: router
        required: true
        type: string
      - description: 回调类型（可选），用于标识回调类型
        in: query
        name: _type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 回调处理成功
          schema:
            $ref: '#/definitions/dto.RequestAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 回调应用
      tags:
      - 应用接口请求(运行函数)
  /api/v1/directory_update_history/app_version:
    get:
      consumes:
      - application/json
      description: 查看整个应用在某个版本的所有目录变更，方便从app侧回滚。返回二维数组结构：一个app有多个版本，每个版本里有数组列举了多个目录的变更
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 应用ID
        in: query
        name: app_id
        required: true
        type: integer
      - description: 应用版本号，如 v101 (可选，如果为空则返回所有版本)
        in: query
        name: app_version
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/dto.GetAppVersionUpdateHistoryResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取应用版本更新历史
      tags:
      - 目录更新历史
  /api/v1/directory_update_history/directory:
    get:
      consumes:
      - application/json
      description: 查看单个目录的变更历史，方便仅回滚某个目录
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 应用ID
        in: query
        name: app_id
        required: true
        type: integer
      - description: 目录完整路径，如 /luobei/app/servercenter/erp
        in: query
        name: full_code_path
        required: true
        type: string
      - description: 页码，默认1
        in: query
        name: page
        type: integer
      - description: 每页数量，默认10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/dto.GetDirectoryUpdateHistoryResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取目录更新历史
      tags:
      - 目录更新历史
  /api/v1/function/get:
    get:
      consumes:
      - application/json
      description: 根据函数ID获取函数的详细信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 函数ID
        in: query
        name: function_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/dto.GetFunctionResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "404":
          description: 函数不存在
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取函数详情
      tags:
      - 函数管理
  /api/v1/function/list:
    get:
      consumes:
      - application/json
      description: 根据应用ID获取该应用下的所有函数列表
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 应用ID
        in: query
        name: app_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/dto.GetFunctionsByAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取应用下所有函数
      tags:
      - 函数管理
  /api/v1/operate_log/form:
    get:
      consumes:
      - application/json
      description: 查询 Form 操作日志（需要企业版 License）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 租户用户（app 的所有者）
        in: query
        name: tenant_user
        type: string
      - description: 请求用户（实际执行操作的用户）
        in: query
        name: request_user
        type: string
      - description: 应用名
        in: query
        name: app
        type: string
      - description: 完整代码路径
        in: query
        name: full_code_path
        type: string
      - description: 操作类型：request_app, form_submit
        in: query
        name: action
        type: string
      - default: 1
        description: 页码（从1开始）
        in: query
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: page_size
        type: integer
      - description: 排序字段（默认：created_at DESC）
        in: query
        name: order_by
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/dto.GetFormOperateLogsResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "403":
          description: 需要企业版 License
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 查询 Form 操作日志
      tags:
      - 操作日志
  /api/v1/operate_log/table:
    get:
      consumes:
      - application/json
      description: 查询 Table 操作日志（需要企业版 License）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 租户用户（app 的所有者）
        in: query
        name: tenant_user
        type: string
      - description: 请求用户（实际执行操作的用户）
        in: query
        name: request_user
        type: string
      - description: 应用名
        in: query
        name: app
        type: string
      - description: 完整代码路径
        in: query
        name: full_code_path
        type: string
      - description: 记录ID
        in: query
        name: row_id
        type: integer
      - description: 操作类型：OnTableAddRow, OnTableUpdateRow, OnTableDeleteRows
        in: query
        name: action
        type: string
      - default: 1
        description: 页码（从1开始）
        in: query
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: page_size
        type: integer
      - description: 排序字段（默认：created_at DESC）
        in: query
        name: order_by
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/dto.GetTableOperateLogsResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "403":
          description: 需要企业版 License
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 查询 Table 操作日志
      tags:
      - 操作日志
  /api/v1/run/{full_code_path}:
    get:
      consumes:
      - application/json
      - application/x-www-form-urlencoded
      - multipart/form-data
      - text/plain
      parameters:
      - description: 应用名
        in: path
        name: app
        required: true
        type: string
      - description: 接口路由路径
        in: path
        name: router
        required: true
        type: string
      - description: 应用内部方法名（可选）
        in: query
        name: method
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 请求成功
          schema:
            $ref: '#/definitions/dto.RequestAppResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      tags:
      - 应用接口请求(运行函数)
  /api/v1/service_tree:
    delete:
      consumes:
      - application/json
      description: 删除指定服务目录（级联删除子目录）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 删除服务目录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.DeleteServiceTreeReq'
      produces:
      - application/json
      responses:
        "200":
          description: 删除成功
          schema:
            type: string
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 删除服务目录
      tags:
      - 服务目录
    get:
      consumes:
      - application/json
      description: 获取指定应用的服务目录树形结构，支持按类型过滤（如只显示 package 类型的节点）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 用户名
        in: query
        name: user
        required: true
        type: string
      - description: 应用名
        in: query
        name: app
        required: true
        type: string
      - description: 节点类型过滤（可选），如：package（只显示服务目录/包）、function（只显示函数/文件）
        in: query
        name: type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.GetServiceTreeResp'
            type: array
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 获取服务目录树
      tags:
      - 服务目录
    post:
      consumes:
      - application/json
      description: 为指定应用创建服务目录
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 创建服务目录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CreateServiceTreeReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.CreateServiceTreeResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 创建服务目录
      tags:
      - 服务目录
    put:
      consumes:
      - application/json
      description: 更新指定服务目录的信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 更新服务目录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateServiceTreeReq'
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            type: string
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 更新服务目录
      tags:
      - 服务目录
  /api/v1/service_tree/copy:
    post:
      consumes:
      - application/json
      description: 递归复制服务目录及其所有子目录到目标目录，保持目录结构
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 复制请求，source_directory_path=源目录完整路径，target_directory_path=目标目录完整路径
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CopyDirectoryReq'
      produces:
      - application/json
      responses:
        "200":
          description: 复制成功
          schema:
            $ref: '#/definitions/dto.CopyDirectoryResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 复制服务目录
      tags:
      - 服务目录
  /api/v1/service_tree/publish_to_hub:
    post:
      consumes:
      - application/json
      description: 将指定目录及其所有子目录发布到 Hub 市场
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 发布目录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.PublishDirectoryToHubReq'
      produces:
      - application/json
      responses:
        "200":
          description: 发布成功
          schema:
            $ref: '#/definitions/dto.PublishDirectoryToHubResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未授权
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 发布目录到 Hub
      tags:
      - 服务目录
  /api/v1/user/info:
    get:
      consumes:
      - application/json
      description: 根据请求header中的username获取当前登录用户信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 用户信息
          schema:
            $ref: '#/definitions/dto.UserInfo'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "404":
          description: 用户不存在
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 获取当前登录用户信息
      tags:
      - 用户管理
  /api/v1/user/query:
    get:
      consumes:
      - application/json
      description: 根据用户名精确查询用户信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 用户名
        in: query
        name: username
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 用户信息
          schema:
            $ref: '#/definitions/dto.QueryUserResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "404":
          description: 用户不存在
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 根据用户名精确查询用户
      tags:
      - 用户管理
  /api/v1/user/search_fuzzy:
    get:
      consumes:
      - application/json
      description: 根据关键词模糊查询用户（支持用户名、邮箱和昵称）
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 搜索关键词
        in: query
        name: keyword
        required: true
        type: string
      - description: 返回数量限制，默认10，最大100
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 用户列表
          schema:
            $ref: '#/definitions/dto.SearchUsersFuzzyResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 模糊查询用户
      tags:
      - 用户管理
  /api/v1/user/update:
    put:
      consumes:
      - application/json
      description: 更新当前登录用户的昵称、签名、头像、性别等信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 更新用户信息请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateUserReq'
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            $ref: '#/definitions/dto.UpdateUserResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "404":
          description: 用户不存在
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: 更新用户信息
      tags:
      - 用户管理
  /api/v1/users:
    post:
      consumes:
      - application/json
      description: 根据用户名列表批量获取用户信息
      parameters:
      - description: JWT Token
        in: header
        name: X-Token
        required: true
        type: string
      - description: 批量查询请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.GetUsersByUsernamesReq'
      produces:
      - application/json
      responses:
        "200":
          description: 用户列表
          schema:
            $ref: '#/definitions/dto.GetUsersByUsernamesResp'
        "400":
          description: 请求参数错误
          schema:
            type: string
        "401":
          description: 未认证
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 批量获取用户信息
      tags:
      - 用户管理
  /control/api/v1/license/activate:
    post:
      consumes:
      - application/json
      description: 上传License文件并激活企业版
      parameters:
      - description: License文件内容（JSON格式）
        in: body
        name: license
        required: true
        schema:
          type: string
      produces:
      - application/json
      responses:
        "200":
          description: 激活成功
          schema:
            additionalProperties: true
            type: object
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 激活 License
      tags:
      - License管理
  /control/api/v1/license/deactivate:
    post:
      consumes:
      - application/json
      description: 注销当前 License，删除激活信息，系统回到社区版（主要用于测试）
      produces:
      - application/json
      responses:
        "200":
          description: 注销成功
          schema:
            additionalProperties: true
            type: object
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 注销 License
      tags:
      - License管理
  /control/api/v1/license/status:
    get:
      consumes:
      - application/json
      description: 获取当前 License 的状态信息
      produces:
      - application/json
      responses:
        "200":
          description: License状态
          schema:
            $ref: '#/definitions/service.LicenseStatus'
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 获取 License 状态
      tags:
      - License管理
  /workspace/api/v1/service_tree/add_functions:
    post:
      consumes:
      - application/json
      description: |-
        接收来自 agent-server 的代码，写入到工作空间对应的目录下，并更新工作空间

        **处理模式**：
        - async=true: 异步处理，立即返回 202 Accepted，后台处理完成后通过回调通知 agent-server
        - async=false: 同步处理，等待处理完成后直接返回结果

        **回调机制**：
        - 异步模式下，处理完成后会调用 agent-server 的回调接口：POST /agent/api/v1/workspace/update/callback
        - 回调会携带处理结果（成功/失败、生成的函数组代码列表等）
      parameters:
      - description: 追踪ID（用于链路追踪）
        in: header
        name: X-Trace-Id
        type: string
      - description: 请求用户（用于审计）
        in: header
        name: X-Request-User
        type: string
      - description: Token（服务间调用时透传）
        in: header
        name: X-Token
        type: string
      - description: 添加函数请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AddFunctionsReq'
      produces:
      - application/json
      responses:
        "200":
          description: 处理成功（同步模式）
          schema:
            $ref: '#/definitions/dto.AddFunctionsResp'
        "202":
          description: 已接收，处理中（异步模式）
          schema:
            additionalProperties: true
            type: object
        "400":
          description: 请求参数错误
          schema:
            type: string
        "500":
          description: 服务器内部错误
          schema:
            type: string
      summary: 向服务目录添加函数
      tags:
      - 服务目录
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: X-Token
    type: apiKey
  BasicAuth:
    type: basic
swagger: "2.0"
